\input{header.tex}

\begin{document}

\maketitle

\section*{Aufgabe 0: Verständnisfragen}

\section*{Aufgabe 1: Distributivgesetz in der Floating-Arithmetik}
Z.z.:
\begin{equation*}
  (a \oplus b) \odot c = a \odot c \oplus b \odot c
\end{equation*}
\noindent
Wähle passend zu $t=2$ (Mantissenlänge) und $l=1$ (Exponentenlänge) $a$, $b$ und $c$,
zum Beispiel: $a=\num{0,43e2}$, $b=\num{0,87e1}$ und $c=\num{0,13e3}$

\begin{align*}
\begin{rcases}
  (\num{0,43e2} \oplus \num{0,87e1}) \odot \num{0,13e3}
  = \num{0,52e2} \odot \num{0,13e3}
  = \num{0,68e4} \\
  \num{0,43e2} \odot \num{0,13e3} \oplus \num{0,87e1} \odot  \num{0,13e3}
  = \num{0,56e4} \oplus \num{0,11e4}
  = \num{0,67e4}
\end{rcases}
{\ne}
\end{align*}
\noindent
Folglich ist das Distributivgesetz  nicht erfüllt:
$\implies (a \oplus b) \odot c \ne a \odot c \oplus b \odot c$

\section*{Aufgabe 2: Rundungsfehler}
Auslöschung tritt auf, wenn $f(x) \approx 0$. Vermeiden lässt sich Auslöschung durch Umformung.
Der relative Fehler zwischen direktem und verbesserten Wert berechnet sich gemäß:
\begin{equation*}
  \frac{\vert x - \bar{x} \vert}{\vert x \vert}
\end{equation*}
a) für große $x \gg 1$
\begin{align*}
  \frac{1}{\sqrt{x}}-\frac{1}{\sqrt{x+1}} &= \frac{1}{\sqrt{x+1} \cdot \sqrt{x}} \cdot \left(\sqrt{x+1} - \sqrt{x}\right) \\
                                          &= \frac{1}{\sqrt{x+1} \cdot \sqrt{x}} \cdot \frac{1}{\sqrt{x+1}+\sqrt{x}}
\end{align*}

b) für kleine $x \ll 1$
\begin{align*}
  \frac{1-\cos \left(x \right)}{\sin \left(x \right)} &= \frac{2 \sin^2 \left(\frac{x}{2}\right)}{2 \sin \left(\frac{x}{2}\right) \cos \left(\frac{x}{2}\right)} \\
                                                      &= \tan \left(\frac{x}{2}\right)
\end{align*}

c) für kleine $\delta \ll 1$
\begin{align*}
  \sin \left(x + \delta \right) - \sin \left(x \right) &= \sin \left(x + \frac{\delta}{2} + \frac{\delta}{2}\right) - \sin \left(x + \frac{\delta}{2} - \frac{\delta}{2} \right) \\
                                                       &= 2 \cos \left(x + \frac{\delta}{2}\right) \sin \left(\frac{\delta}{2}\right)
\end{align*}

Die Ergebnisse der direkten und verbesserten Berechnung befinden sich in Abbildung \ref{fig:plot2a} für Aufgabenteil a), in  Abbildung \ref{fig:plot2b}
für Aufgabenteil b) und in  Abbildung \ref{fig:plot2c} für Teil c).

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{a_2_a.pdf}
    \caption{Aufgabe 2a: Vergleich der direkten Berechnung und der verbesserten Berechung für sehr kleine Werte von $x$.}
    \label{fig:plot2a}
\end{figure}

\FloatBarrier
\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{a_2_b.pdf}
    \caption{Aufgabe 2b: Vergleich der direkten Berechnung und der verbesserten Berechung für sehr kleine Werte von $x$.}
    \label{fig:plot2b}
\end{figure}
\FloatBarrier

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{a_2_c.pdf}
    \caption{Aufgabe 2c: Vergleich der direkten Berechnung und der verbesserten Berechung für sehr kleine Werte von $x$.}
    \label{fig:plot2c}
\end{figure}
\FloatBarrier

Bei der Betrachtung der relativen Fehler fällt deutlich der Unterschied zwischen der ersten und der zweiten
und dritten Berechnung auf. Während der relative Fehler bei Aufgabenteil b) und c) zunächst erst sehr groß ist,
nimmt er dann jedoch schnell ab und wir sehr klein, wenn auchg mit einigen Schwankungen. Bei Aufgabenteil a)
wird der Fehler jedoch zunehmend immer größer.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{a_2_rel_err.pdf}
    \caption{Aufgabe 2: Vergleich der relativen Fehler für die Aufgabenteile a) bis c).}
    \label{fig:plot2_err}
\end{figure}
\FloatBarrier

\section*{Aufgabe 3: Stabilität}
Anfangswertproblem:
\begin{align*}
  \dot{y}(t)&=-y(t), \\ y(0)&=1 \\
  \intertext{Analytische Lösung:} y(t)&=e^{t}
\end{align*}

\subsection*{a)}
Anfangswerte:
\begin{align*}
  y_0&=1\\
  \intertext{und für das symmetrische Euler-Verfahren zusätzlich}
  y_1&=e^{-\Delta t}
\end{align*}
Für eine Schrittweite von $\Delta t = 0,1$ ergibt sich auf dem Intervall [0, 10] folgene Funktion als Lösung des Anfangswertproblems.
\FloatBarrier
\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{plot3a.pdf}
    \caption{Aufgabe 3a: Lösung des AWP mittels Euler-Verfahrens und symmetrischen Euler-Verfahrens und rauschfreien Anfangswerten.}
    \label{fig:plot3a}
\end{figure}
\FloatBarrier
Für die gegebenen Startwerte ist die Lösung des Anfangswertproblems sowohl mittels Euler-Verfahrens als auch mittels symmetrischen Euler Verfahrens sehr genau, da kaum ein Unterschied zwischen den Funktionen erkennbar ist.

\subsection*{b)}
Anfangswerte für das Euler-Verfahren:
\begin{align*}
  y_0&=1-\Delta t\\
  \intertext{Anfangswerte für das symmetrische Euler-Verfahren:}\\
  y_0&=1\\
  y_1&=y_0-\Delta t
\end{align*}
Mit der gleichen Schrittweite wie in a) ergibt sich mit den angegebenen Startwerten folgene Funktion als Lösung des Anfangswertproblems.
\FloatBarrier
\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{plot3b.pdf}
    \caption{Aufgabe 3b: Lösung des AWP mittels Euler Verfahrens und symmetrischen Euler-Verfahrens und rauschbelasteten Anfangswerten.}
    \label{fig:plot3a}
\end{figure}
\FloatBarrier
Hier ist deutlich erkennbar, dass das Rauschen zu einer Instabilität des symmetrischen Euler-Verfahrens führt. Die Lösung dieses Verfahrens weicht auf dem gegebenen Intervall deutlich stärker von der analytischen Lösung ab, als die Lösung, welche durch das symmetrische Euler-Verfahren bestimmt wurde. Damit wurde anhand eines Beispiels gezeigt, dass das symmetrische Euler-Verfahren instabil gegenüber kleinen Fehlern (hier in der Größenordnung der Schrittweite) in den Anfangswerten ist.
\end{document}
